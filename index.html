<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOW</title>
    <script src="https://unpkg.com/packery@2/dist/packery.pkgd.min.js"></script>
    <!-- <script src="packery.pkgd.min.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://unpkg.com/draggabilly@3/dist/draggabilly.pkgd.min.js"></script>
    <link rel="stylesheet" href="style.css">

    <script>

$(document).ready(function(){
    $('.button-container').click(function() {
        // Your code here
        var correct_order = true
        pckry.getItemElements().forEach(itemElem => {
            console.log('Index:', $(itemElem).attr("index"));
            console.log('Position of item:', itemElem.style.left);
            if (itemElem.style.left != $(itemElem).attr("index")*210+"px") {
              console.log('Position of item:', itemElem.style.left);
              console.log('Index:', $(itemElem).attr("index")*210+"px");
              correct_order = false
            }
            });
         if (correct_order == true){
          $('#result').text('Order is correct!');
         } else {
          $('#result').text('Order is not correct!');
         }
         
        
        update_button();
    });
  var i = 0;
  // let arr = [0, 1, 2, 3, 4, 5, 6];
  // arr.sort(() => Math.random() - 0.5);
  // console.log(arr)
  pckry.getItemElements().forEach(itemElem => {
    $(itemElem).attr('index', i)
    // itemElem.style.left=arr[i]*210+'px'
    i=(i+1);
  })
});

// jQuery
function update_button(event, pointer){
    pckry.getItemElements().forEach(itemElem => {
      console.log('Position of item:', itemElem.style.left);
    });
}


document.addEventListener("DOMContentLoaded", runPackery, false);
var pckry;
function runPackery() {
  pckry = new Packery(".grid", {
    itemSelector: ".grid-item",
    columnWidth: 200,
    gutter: 10,
    horizontal: true
  });
  
  pckry.getItemElements().forEach(itemElem => {
    
    let draggie = new Draggabilly(itemElem, {
      //containment: '.grid', // limit item with in boundary of container
      handle: '.oxy-card',
      axis: 'x',
      containment: '.demo--containment__container'
    });
    draggie.on( 'dragEnd', update_button)
    pckry.bindDraggabillyEvents(draggie);
  });
  
  document.querySelector('.grid')
    .addEventListener('click', collapse, false);
}

function collapse(ev) {
  let isExpanded = false;
  let target = ev.target;
  let gridItem = target.closest('.grid-item');
  
  if (!target.getAttribute('class').match(/(collapsable|expand1x|expand2x)/i))   {
    return;
  }
  
  if (target.getAttribute('class').match(/collapsable/i)) {
      gridItem.classList.toggle('collapsed');
      isExpanded = !gridItem.classList.contains('collapsed');        
  }
  
  if (target.getAttribute('class').match(/expand1x/i) &&  gridItem.classList.contains('twox')) {
      gridItem.classList.remove('twox');
      isExpanded = false;        
  }
  
  if (target.getAttribute('class').match(/expand2x/i) &&  !gridItem.classList.contains('twox')) {
      gridItem.classList.add('twox');
      isExpanded = true;        
  }
  
  isExpanded ? pckry.fit(gridItem) : pckry.shiftLayout();
  
  
}

if (window.Element && !Element.prototype.closest) {
  Element.prototype.closest = function(s) {
    var matches = (this.document || this.ownerDocument).querySelectorAll(s),
      i,
      el = this;
    do {
      i = matches.length;
      while (--i >= 0 && matches.item(i) !== el) {}
    } while (i < 0 && (el = el.parentElement));
    return el;
  };
}
    </script>
</head>
<body>

    <div class="demo--containment__container">
        
    <div class="grid">

        <!---->
        <div class="grid-item  mdl-shadow--2dp">
          <oxy-card>
            <div class="oxy-card" style="background:#feabcd">
              <!---->
              <h6 class="oxy-card-title">First computer algorithm &nbsp;
              </h6>
              <div class="image_box">
                <img src="Pictures/resized/lovelace.jpg" style="width:200px;">
              </div>
              <span class="collapsable">More information</span>
              <div class="oxy-card-content">
                <div>
                    The first computer algorithm was invented by Ada Lovelace to calculate the sequence of Bernoulli numbers.
                </div>
              </div>
            </div>
          </oxy-card>
        </div>
        
        <div class="grid-item twox ">
          <oxy-card>
            <div class="oxy-card mdl-shadow--2dp" style="background:#4286f4">
              <!---->
              <h6 class="oxy-card-title">Discovery of x-rays  &nbsp;
              </h6>
              <div class="image_box">
                <img src="Pictures/resized/rontgen.jpg" style="width:200px;">
              </div>
              <span class="collapsable">More information</span>
              <div class="oxy-card-content">
                <div>
                  The picture shows the first medical x-ray image, taken of Anna Bertha Ludwig's hand by Wilhelm RÃ¶ntgen shortly after his discovery of x-rays.
                </div>
              </div>
            </div>
          </oxy-card>
        </div>
        
          <div class="grid-item  mdl-shadow--2dp">
          <oxy-card>
            <div class="oxy-card"  style="background:#84ffda">
              <!---->
              <h6 class="oxy-card-title">X-rays in use in WW1  &nbsp;
              </h6>
              <div class="image_box">
                <img src="Pictures/resized/curie.jpg" style="width:200px;">
              </div>
              <span class="collapsable">More information</span>
              <div class="oxy-card-content">
                <div>
                  X-rays were in use as a diagnostic tool in world war 1. The picture shows a mobile x-ray unit developed and run by Nobel prize winner Marie Curie.
                </div>
              </div>
            </div>
          </oxy-card>
        </div>
        
          <div class="grid-item  mdl-shadow--2dp">
          <oxy-card>
            <div class="oxy-card" style="background:#d7ffba">
              <!---->
              <h6 class="oxy-card-title">Radon transform &nbsp;
              </h6>
              <div class="image_box">
                <img src="Pictures/resized/radon.jpg" style="width:200px;">
              </div>
              <span class="collapsable">More information</span>
              <div class="oxy-card-content">
                <div>
                  Johann Radon first described the transformation required to reconstruct a volume from 2D x-ray projections.
                </div>
              </div>
            </div>
          </oxy-card>
        </div>
        
          <div class="grid-item  mdl-shadow--2dp">
          <oxy-card>
            <div class="oxy-card" style="background:#ffd3ba">
              <!---->
              <h6 class="oxy-card-title">Programmable computer &nbsp;
              </h6>
              <div class="image_box">
                <img src="Pictures/resized/baby.jpg" style="width:200px;">
              </div>
              <span class="collapsable">More information</span>
              <div class="oxy-card-content">
                <div>
                  The Manchester baby machine was the first stored program computer. Its development paved the way for using computers for complex calculations, like tomographic reconstruction.
                </div>
              </div>
            </div>
          </oxy-card>
        </div>
        
          <div class="grid-item  mdl-shadow--2dp">
          <oxy-card>
            <div class="oxy-card" style="background:#ffbaf2">
              <!---->
              <h6 class="oxy-card-title">First CT scanner  &nbsp;
              </h6>
              <div class="image_box">
                <img src="Pictures/resized/baby.jpg" style="width:200px;">
              </div>
              <span class="collapsable">More information</span>
              <div class="oxy-card-content">
                <div>
                  This needs to be a different picture
                </div>
              </div>
            </div>
          </oxy-card>
        </div>
        
        <div class="grid-item  mdl-shadow--2dp">
          <oxy-card>
            <div class="oxy-card" style="background:#adffff">
              <!---->
              <h6 class="oxy-card-title">Tomography Nobel Prize  &nbsp;
              </h6>
              <div class="image_box">
                <img src="Pictures/resized/cormack_hounsfield.png" style="width:200px;">
              </div>
              <span class="collapsable">More information</span>
              <div class="oxy-card-content">
                <div>
                  The Nobel Prize in Physiology or Medicine was awarded to Allan Cormack and Geoffrey Hounsfield for their work on computer assisted tomography.
                </div>
              </div>
            </div>
          </oxy-card>
        </div>
      </div>

    </div>
      <div class="button-container">
        <button type="button">Check order</button>
    </div>
    <div id="result">
        <!-- Here to appear the result -->
    </div>
</body>
</html>